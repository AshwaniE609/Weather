{"version":3,"sources":["../../src/datasources/openweather.ts"],"sourcesContent":["import { GSContext, GSDataSource, GSStatus, PlainObject } from \"@godspeedsystems/core\";\nimport axios from \"axios\";\n\nexport default class OpenWeatherDataSource extends GSDataSource {\n  async initClient(): Promise<PlainObject> {\n    const client = axios.create({\n      baseURL: this.config.base_url || \"https://api.openweathermap.org/data/2.5\"\n    });\n    return client;\n  }\n\n  async execute(ctx: GSContext, args: PlainObject): Promise<GSStatus> {\n    try {\n      const city = args.meta?.city || \"London\";\n      const apiKey = this.config.api_key;\n\n      const response = await this.client.get(\"/weather\", {\n        params: {\n          q: city,\n          appid: apiKey\n        }\n      });\n\n      return new GSStatus(true, 200, \"Weather fetched!\", response.data);\n    } catch (err: any) {\n      ctx.childLogger.error(\"Error fetching weather\", err);\n      return new GSStatus(false, 500, \"Failed to fetch weather\", { error: err.message });\n    }\n  }\n}\n\nconst SourceType = \"DS\";\nconst Type = 'REST';\nconst CONFIG_FILE_NAME = \"openweather\"; // this links to your YAML\nconst DEFAULT_CONFIG = {\n  base_url: \"https://api.openweathermap.org/data/2.5\",\n  api_key: \"027535cb5e8f9cc8283ec06315a2b272\"\n};\n\nexport {\n  OpenWeatherDataSource as DataSource,\n  SourceType,\n  Type,\n  CONFIG_FILE_NAME,\n  DEFAULT_CONFIG\n};\n\n"],"names":["CONFIG_FILE_NAME","DEFAULT_CONFIG","DataSource","OpenWeatherDataSource","SourceType","Type","GSDataSource","initClient","client","axios","create","baseURL","config","base_url","execute","ctx","args","city","meta","apiKey","api_key","response","get","params","q","appid","GSStatus","data","err","childLogger","error","message"],"mappings":";;;;;;;;;;;IA2CEA,gBAAgB;eAAhBA;;IACAC,cAAc;eAAdA;;IAJyBC,UAAU;eAAnCC;;IACAC,UAAU;eAAVA;;IACAC,IAAI;eAAJA;;;eAvCmBF;;;sBAH0C;8DAC7C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEH,MAAMA,8BAA8BG,kBAAY;IACvDC;;YACJ,MAAMC,SAASC,cAAK,CAACC,MAAM,CAAC;gBAC1BC,SAAS,IAAI,CAACC,MAAM,CAACC,QAAQ,IAAI;YACnC;YACA,OAAOL;QACT;;IAEMM,QAAQC,GAAc,EAAEC,IAAiB;;YAC7C,IAAI;oBACWA;gBAAb,MAAMC,OAAOD,EAAAA,aAAAA,KAAKE,IAAI,cAATF,iCAAAA,WAAWC,IAAI,KAAI;gBAChC,MAAME,SAAS,IAAI,CAACP,MAAM,CAACQ,OAAO;gBAElC,MAAMC,WAAW,MAAM,IAAI,CAACb,MAAM,CAACc,GAAG,CAAC,YAAY;oBACjDC,QAAQ;wBACNC,GAAGP;wBACHQ,OAAON;oBACT;gBACF;gBAEA,OAAO,IAAIO,cAAQ,CAAC,MAAM,KAAK,oBAAoBL,SAASM,IAAI;YAClE,EAAE,OAAOC,KAAU;gBACjBb,IAAIc,WAAW,CAACC,KAAK,CAAC,0BAA0BF;gBAChD,OAAO,IAAIF,cAAQ,CAAC,OAAO,KAAK,2BAA2B;oBAAEI,OAAOF,IAAIG,OAAO;gBAAC;YAClF;QACF;;AACF;AAEA,MAAM3B,aAAa;AACnB,MAAMC,OAAO;AACb,MAAML,mBAAmB,eAAe,0BAA0B;AAClE,MAAMC,iBAAiB;IACrBY,UAAU;IACVO,SAAS;AACX"}